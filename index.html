<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>NutriMate</title>

<!-- 
  üß† Project: NutriMate ‚Äî Personal AI Diet Planner
  üìÖ Version: 1.0
  üë®‚Äçüíª Developer: Ishaan Sareen and Atharv Ajmani
  ü§ñ Description:
      NutriMate is an AI-powered diet planner that interacts with users,
      collects health and lifestyle details, and generates a personalized
      diet plan using the Groq API (LLaMA model). The system calculates
      calorie needs and produces balanced meal suggestions.
  üßæ Features:
      - Dynamic chatbot-style question flow
      - Calorie calculation based on Mifflin-St Jeor formula
      - Cuisine-based meal generation
      - PDF export of generated diet plan
  ‚ö†Ô∏è License:
      This project is for educational and personal use only.
      Do not redistribute or commercialize without permission.
-->

<style>
  body {
    font-family: Poppins, system-ui;
    background: linear-gradient(135deg, #0f1724, #0b1220);
    color: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
    margin: 0;
    padding: 20px;
    flex-direction: column;
  }

  .card {
    width: 520px;
    max-width: 96%;
    background: rgba(255, 255, 255, 0.03);
    padding: 18px;
    border-radius: 14px;
    backdrop-filter: blur(8px);
    box-shadow: 0 10px 40px rgba(0, 0, 0, .6);
    border: 1px solid rgba(255, 255, 255, 0.04);
  }

  h1 {
    margin: 0 0 12px;
    font-size: 20px;
    text-align: center;
  }

  #chat {
    height: 380px;
    overflow-y: auto;
    padding: 12px;
    border-radius: 10px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
  }

  .bubble {
    max-width: 82%;
    padding: 10px;
    border-radius: 12px;
    margin: 8px 0;
    white-space: pre-wrap;
  }

  .user {
    margin-left: auto;
    background: linear-gradient(145deg, #00e6a1, #00c487);
    color: #002b20;
  }

  .bot {
    background: linear-gradient(145deg, #4c51ff, #7a81ff);
    color: white;
  }

  #promptArea {
    margin-top: 12px;
    display: flex;
    gap: 8px;
    align-items: center;
  }

  input, select {
    flex: 1;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, .06);
    background: rgba(255, 255, 255, .02);
    color: #fff;
  }

  button {
    padding: 10px 12px;
    border-radius: 8px;
    border: none;
    background: #fff;
    color: #000;
    cursor: pointer;
    font-weight: 700;
  }

  footer {
    text-align: center;
    font-size: 13px;
    opacity: 0.6;
    margin-top: 15px;
  }
  @keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-8px); }
  50% { transform: translateX(8px); }
  75% { transform: translateX(-8px); }
}
.shake {
  animation: shake 0.3s ease;
}
</style>
</head>

<body>
<div class="card">
  <h1>üçè NutriMate: Your Personal AI Diet Planner</h1>
  <div id="chat" role="log" aria-live="polite"></div>
  <div id="promptArea"></div>
</div>

<!-- üìú Copyright Footer -->
<footer>
  ¬© 2025 NutriMate by Ishaan Sareen and Atharv Ajmani. All rights reserved.
</footer>


<script type="module">
// ‚úÖ Groq API Key
const OPENAI_API_KEY = "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";

// ‚úÖ Works now
const API_URL = "https://api.groq.com/openai/v1/chat/completions";

const chat = document.getElementById("chat");
const promptArea = document.getElementById("promptArea");

function append(role, text) {
  const bubble = document.createElement("div");
  bubble.className = `bubble ${role}`;
  bubble.textContent = text || "No response found.";
  chat.appendChild(bubble);
  chat.scrollTop = chat.scrollHeight;
}

// === Questions ===
localStorage.removeItem("nutriUser");
const answers = {};

const questions = [
  { key: "name", q: "What is your name?", type: "text" },
  { key: "age", q: "Age?", type: "number" },
  { key: "gender", q: "Gender?", type: "select", options: ["Male","Female","Other"] },
  { key: "height_cm", q: "Height (cm)?", type: "number" },
  { key: "weight_kg", q: "Weight (kg)?", type: "number" },
  { key: "dietType", q: "Diet preference?", type: "select", options: ["Veg","Non-Veg","Vegan","Other"] },
  { key: "allergies", q: "Any allergies?", type: "text" },
  { key: "activity", q: "Activity level?", type: "select", options: ["Low","Moderate","High"] },
  {
    key: "region",
    q: "Cuisine preference?",
    type: "select",
    options: ["Indian","Chinese","Italian","Japanese","Continental","Thai","Mediterranean","Fusion"]
  },
  { key: "goal", q: "Main goal?", type: "text" },
];

let index = 0;

// === Calorie Calculator ===
function calculateCalories(age, gender, weight, height, activity) {
  age = Number(age);
  weight = Number(weight);
  height = Number(height);

  let bmr;
  if (gender.toLowerCase() === "male")
    bmr = 10 * weight + 6.25 * height - 5 * age + 5;
  else if (gender.toLowerCase() === "female")
    bmr = 10 * weight + 6.25 * height - 5 * age - 161;
  else
    bmr = 10 * weight + 6.25 * height - 5 * age;

  const factor = activity === "High" ? 1.7 :
                 activity === "Moderate" ? 1.55 : 1.3;

  return Math.round(bmr * factor);
}

// === UI Rendering ===
function renderQuestion(i) {
  promptArea.innerHTML = "";
  if (i >= questions.length) return endQuestions();

  const q = questions[i];
  append("bot", q.q);

  let input = q.type === "select" ? createSelect(q.options) : createInput(q.type);
  input.id = "answerInput";

  promptArea.appendChild(input);

  const btn = document.createElement("button");
  btn.textContent = (i === questions.length - 1) ? "Submit" : "Next";
  btn.onclick = handleAnswer;

  promptArea.appendChild(btn);
  input.focus();
  input.addEventListener("keydown", e => e.key === "Enter" && handleAnswer());
}

function createInput(type) {
  const inp = document.createElement("input");
  inp.type = type || "text";
  return inp;
}

function createSelect(opts) {
  const sel = document.createElement("select");
  const defaultOption = document.createElement("option");
  defaultOption.textContent = "Select...";
  defaultOption.value = "";
  sel.appendChild(defaultOption);
  opts.forEach(o => {
    const op = document.createElement("option");
    op.value = o;
    op.textContent = o;
    sel.appendChild(op);
  });
  return sel;
}

// === Validation ===
// === Validation ===
function isValid(q, val) {
  if (!val || val.trim() === "") return false;

  // ‚úÖ Common sense checks
  if (q.key === "age" && (val <= 0 || val > 100)) return false;
  if (q.key === "weight_kg" && (val <= 0 || val > 200)) return false;
  if (q.key === "height_cm" && val <= 0) return false;

  // ‚úÖ Reject nonsense for text fields
  if (["name", "goal", "allergies"].includes(q.key)) {
    const nonsense = /(.)\1{2,}|[^a-zA-Z\s]/g; // repeating letters or symbols
    if (val.length < 2 || val.length > 30) return false;
    if (nonsense.test(val)) return false;
    if (["test", "none", "chu chu tv", "asdf", "qwerty", "xyz", "Sky", "ocean", "mountain", "river", "valley", "forest", "desert", "storm", "cloud", "thunder", "lightning", "sunrise", "sunset", "twilight", "breeze", "meadow", "horizon", "galaxy", "planet", "comet", "star", "universe", "eclipse", "gravity", "motion", "silence", "whisper", "echo", "harmony", "melody", "rhythm", "sound", "vibration", "pulse", "energy", "spark", "flame", "ember", "crystal", "mineral", "stone", "sand", "coral", "reef", "tide", "current", "waterfall", "rain", "snow", "frost", "mist", "dew", "blossom", "leaf", "root", "branch", "bark", "fruit", "seed", "soil", "grass", "flower", "petal", "pollen", "hive", "butterfly", "dragonfly", "bird", "eagle", "owl", "dove", "falcon", "squirrel", "fox", "wolf", "lion", "tiger", "elephant", "dolphin", "whale", "shark", "turtle", "penguin", "zebra", "horse", "camel", "kangaroo", "rabbit", "bear", "monkey", "panda", "lizard", "snake", "frog", "insect", "beetle", "spider", "ant", "bee", "jellyfish", "octopus", "crab", "coral", "pearl", "shell", "wave", "driftwood", "island", "volcano", "canyon", "cave", "glacier", "cliff", "stone", "rock", "crystal", "gem", "diamond", "gold", "silver", "iron", "steel", "copper", "bronze", "marble", "clay", "pottery", "sculpture", "painting", "music", "art", "design", "color", "shape", "pattern", "rhythm", "tempo", "tone", "echo", "voice", "story", "poem", "dream", "thought", "memory", "time", "future", "present", "past", "destiny", "chance", "fate", "energy", "idea", "creation", "invention", "motion", "balance", "growth", "peace", "power", "courage", "hope", "love", "friendship", "trust", "honesty", "kindness", "laughter", "joy", "wonder", "imagination", "innovation", "science", "technology", "robot", "circuit", "data", "code", "logic", "network", "connection", "signal", "universe", "cosmos", "mystery", "adventure", "travel", "journey", "discovery", "planet", "system", "starlight", "nebula", "infinity", "chaos", "order", "Machine", "gear", "engine", "bolt", "wheel", "piston", "drone", "satellite", "rocket", "astronaut", "orbit", "telescope", "microscope", "laser", "crystal", "lens", "prism", "shadow", "reflection", "mirror", "glass", "metal", "wire", "magnet", "charge", "voltage", "current", "circuit", "resistance", "frequency", "wavelength", "signal", "algorithm", "pattern", "formula", "chemistry", "biology", "physics", "molecule", "atom", "nucleus", "cell", "tissue", "organ", "species", "evolution", "ecosystem", "habitat", "climate", "weather", "rainfall", "drought", "thunderstorm", "temperature", "atmosphere", "ozone", "layer", "cloudburst", "pressure", "humidity", "wind", "tornado", "hurricane", "typhoon", "wave", "ripple", "vibration", "echo", "soundscape", "frequency", "harmony", "composition", "artform", "rhythm", "canvas", "brush", "texture", "pigment", "portrait", "sculpture", "museum", "gallery", "cinema", "theatre", "concert", "stage", "performance", "audience", "actor", "director", "writer", "poet", "novel", "book", "library", "knowledge", "wisdom", "education", "school", "teacher", "classroom", "subject", "science", "mathematics", "geometry", "algebra", "calculus", "equation", "symbol", "number", "graph", "chart", "statistic", "data", "information", "analysis", "logic", "reasoning", "intelligence", "creativity", "imagination", "curiosity", "learning", "discovery", "experiment", "innovation", "prototype", "progress", "evolution", "adaptation", "transformation", "creation", "invention", "industry", "construction", "architecture", "bridge", "building", "tower", "monument", "palace", "temple", "city", "street", "park", "garden", "vehicle", "train", "airplane", "ship", "submarine", "bicycle", "scooter", "road", "highway", "journey", "destination", "map", "compass", "navigation", "direction", "horizon", "landmark", "territory", "border", "country", "planet", "culture", "language", "society", "communication", "message", "signal", "media", "art", "internet", "network", "satellite", "broadcast", "film", "radio", "photograph", "story", "documentary", "creativity", "journalism", "truth", "expression", "perspective", "history", "memory", "timeline", "ancient", "modern", "future", "civilization", "humanity", "world", "earth", "cosmos", "Emotion", "feeling", "thought", "mind", "idea", "dream", "vision", "memory", "reflection", "understanding", "wisdom", "knowledge", "awareness", "insight", "belief", "faith", "truth", "justice", "freedom", "liberty", "unity", "strength", "peace", "hope", "joy", "happiness", "sadness", "anger", "love", "trust", "forgiveness", "gratitude", "compassion", "kindness", "patience", "respect", "honesty", "empathy", "humor", "fear", "curiosity", "confidence", "determination", "motivation", "discipline", "focus", "balance", "stability", "energy", "spirit", "soul", "heart", "body", "breath", "pulse", "motion", "movement", "growth", "change", "progress", "journey", "destination", "goal", "achievement", "success", "failure", "lesson", "experience", "wisdom", "future", "present", "past", "moment", "time", "day", "night", "morning", "evening", "dawn", "dusk", "midnight", "twilight", "shadow", "light", "darkness", "glow", "shine", "spark", "fire", "flame", "ember", "heat", "cold", "breeze", "wind", "storm", "rain", "snow", "hail", "mist", "fog", "frost", "season", "spring", "summer", "autumn", "winter", "year", "month", "week", "hour", "minute", "second", "clock", "calendar", "schedule", "plan", "routine", "habit", "choice", "decision", "path", "road", "route", "direction", "map", "destination", "exploration", "travel", "voyage", "adventure", "journey", "experience", "memory", "story", "legend", "myth", "tale", "narrative", "chapter", "book", "library", "poem", "verse", "word", "sentence", "language", "voice", "sound", "speech", "conversation", "dialogue", "debate", "expression", "articulation", "communication", "message", "signal", "symbol", "meaning", "interpretation", "translation", "understanding", "clarity", "vision", "focus", "perspective", "imagination", "creation", "innovation", "discovery", "exploration", "science", "technology", "engineering", "mathematics", "robotics", "coding", "design", "architecture", "music", "rhythm", "melody", "harmony", "sound", "instrument", "beat", "tempo", "vibration", "note", "tone", "composition", "song", "symphony", "band", "concert", "performance", "stage", "audience", "applause", "drama", "script", "scene", "director", "actor", "camera", "lens", "frame", "film", "studio", "set", "microphone", "light", "shadow", "angle", "focus", "shot", "edit", "screen", "cinema", "visual", "graphic", "animation", "color", "contrast", "texture", "pattern", "form", "shape", "motion", "image", "symbol", "logo", "icon", "style", "theme", "concept", "Structure", "framework", "foundation", "pillar", "bridge", "tower", "building", "architecture", "monument", "cathedral", "temple", "palace", "castle", "fort", "arena", "stadium", "theatre", "gallery", "museum", "library", "university", "college", "school", "classroom", "desk", "chair", "window", "door", "wall", "floor", "ceiling", "roof", "ladder", "staircase", "corridor", "hall", "garden", "park", "forest", "jungle", "field", "meadow", "riverbank", "shore", "island", "peninsula", "continent", "ocean", "sea", "bay", "harbor", "beach", "cliff", "mountain", "peak", "ridge", "valley", "canyon", "plateau", "plain", "desert", "dune", "volcano", "crater", "lava", "ash", "eruption", "glacier", "iceberg", "snowfall", "frost", "hailstorm", "avalanche", "landslide", "earthquake", "tsunami", "tornado", "cyclone", "hurricane", "storm", "rainbow", "sunlight", "moonlight", "starlight", "twilight", "shadow", "reflection", "mirror", "glass", "windowpane", "crystal", "gemstone", "diamond", "ruby", "emerald", "sapphire", "amethyst", "opal", "pearl", "gold", "silver", "bronze", "iron", "copper", "steel", "metal", "alloy", "plastic", "rubber", "wood", "paper", "cloth", "fabric", "leather", "thread", "string", "rope", "chain", "wire", "cable", "device", "gadget", "machine", "robot", "drone", "sensor", "screen", "keyboard", "mouse", "monitor", "camera", "speaker", "microphone", "battery", "charger", "plug", "socket", "switch", "light", "bulb", "lamp", "fan", "motor", "engine", "vehicle", "car", "truck", "bus", "train", "tram", "airplane", "helicopter", "rocket", "satellite", "submarine", "ship", "boat", "canoe", "raft", "bridge", "tunnel", "road", "path", "highway", "lane", "alley", "street", "crosswalk", "intersection", "signal", "traffic", "light", "signboard", "billboard", "advertisement", "poster", "banner", "display", "shop", "market", "store", "mall", "restaurant", "cafe", "theatre", "office", "building", "factory", "warehouse", "workshop", "studio", "farm", "barn", "field", "mine", "quarry", "station", "port", "airport", "harbor", "dock", "pier", "garage", "parking", "lot", "fence", "gate", "garden", "yard", "balcony", "terrace", "roof", "chimney", "window", "curtain", "mirror", "sofa", "table", "bed", "lamp", "clock", "book", "pen", "paper", "painting", "photo", "computer", "phone", "television", "radio", "fan", "air", "water", "fire", "earth", "metal", "wood", "energy", "sound", "light", "motion", "balance", "focus", "design", "pattern", "order", "chaos", "art", "music", "literature", "philosophy", "science", "logic", "reason", "emotion", "imagination", "dream", "reality", "memory", "time", "space", "infinity", "life", "existence", "truth", "freedom", "peace", "justice", "hope", "love", "faith", "harmony", "unity", "energy", "cosmos", "universe", "blibber", "skrunko", "meowbahh", "goobly", "flonk", "yeeb", "skrunkly", "boingus", "smoodle", "zoodle", "glibble", "bloop", "snorf", "yabble", "flimp", "skadoo", "blorbo", "meeble", "gloop", "schlorp", "florp", "plim", "wibble", "snart", "glimmy", "blimblam", "doingo", "yeep", "frooble", "snerp", "poink", "glonk", "squibble", "badoing", "whoob", "glomp", "yoinky", "snoink", "flerp", "zibble", "squarp", "brimbo", "flonkus", "plob", "snungle", "grubble", "woinky", "slarp", "blungo", "mlemp", "zorp", "yoob", "flarb", "sniggle", "womp", "dooble", "groink", "sploonk", "glonkus", "smoob", "snooble", "grobby", "fleep", "snarfle", "grib", "woomp", "splimp", "yumbo", "ploop", "skibidi", "toilet", "rizz", "gyatt", "fanum", "tax", "sigma", "npc", "goofy", "ahh", "skraa", "bing", "bong", "zaza", "brr", "skrrt", "ohio", "mewing", "yapping", "delulu", "corecore", "slay", "blud", "oomf", "griddy", "goob", "beepus", "snartle", "yeeble", "sploink", "flabbity", "zamp", "mlem", "blep", "smorg", "clunkus", "flarp", "snorpt", "boofle", "grink", "yoin", "skriddly", "bloopus", "skwib", "meebleflop", "snibble", "doonk", "bingle", "zoonk", "floop", "skloob", "grumbleton", "snarp", "flimpus", "badoodle", "yabbleflop", "ploing", "doobert", "snorg", "skloingus", "mipp", "frabble", "woing", "glibberish", "snibbleboop", "blop", "yiff", "shmoink", "schlabbity", "plorp", "doinkus", "gloob", "skwunk", "brrrt", "boink", "snork", "yeet", "yomp", "wozz", "snibbleflop", "mlembo", "glorm", "ploof", "binglebop", "yoobly", "flurb", "grobo", "sklonk", "schwib", "flimpblop", "woob", "zazzy", "goon", "spingo", "doodle", "splorf", "blim", "zib", "drongo", "snuzz", "cloop", "flibbity", "blom", "gibble", "mimble", "snarf", "schmoob", "yungo", "drimbly", "snarpus", "floof", "skoob", "snibbleplop", "boingy", "badoink", "woingus", "plooble", "flerbo", "schloing", "mipply", "snop", "brungle", "groinkus", "zombo", "skoodle", "yeebleblorp", "ploingus", "snoof", "mlemmy", "brrbrr", "doodly", "zingo", "sploob", "wibbly", "floink", "yurp", "skorb", "grooble", "flimby", "snorkus", "bloopish", "skoink", "woobly", "zump", "snig", "glooby", "flonkity", "snerbly", "yibber", "mloop", "ploomb", "zibbidy", "snibblezor", "flob", "gloink", "meebleplop", "bribble", "shlomp", "yoinkus", "gloingo", "floopity", "mippus", "badoongo", "sproing", "woinkus", "flibbleflop", "snorpus", "skringle", "zwoop", "smingus", "bloopers", "groobly", "flimpish", "plumbus", "mloink", "skoinkus", "zlorp", "schmoobly", "dringus", "yoobert", "flaff", "ploomp", "glooba", "skwibber", "snibblegoob", "wombo", "snorp", "boinkus", "drumble", "glompus", "blibberish"].includes(val.toLowerCase())) return false;
  }

  return true;
}

function handleAnswer() {
  const el = document.getElementById("answerInput");
  const val = el.value.trim();
  const q = questions[index];
  const card = document.querySelector(".card");

  if (!isValid(q, val)) {
    card.classList.add("shake");
    setTimeout(() => card.classList.remove("shake"), 400);
    return;
  }

  append("user", val);
  answers[q.key] = val;
  index++;

  if (index < questions.length) renderQuestion(index);
  else endQuestions();
}


function endQuestions() {
  promptArea.innerHTML = "";
  append("bot", "Calculating authentic medical-grade diet‚Ä¶ üòé");

  answers.calories = calculateCalories(
    answers.age, answers.gender, answers.weight_kg, answers.height_cm, answers.activity
  );

  answers.completed = true;
  localStorage.setItem("nutriUser", JSON.stringify(answers));

  generateDiet();
}

// === Generate Diet ===
async function generateDiet() {
  const prompt = `
You are a certified global dietician.

Generate a personalized 1-day diet plan based on:

${JSON.stringify(answers, null, 2)}

Cuisine preference must be **${answers.region} style** foods.

Include:
- Breakfast
- Mid-meal snack
- Lunch
- Evening snack
- Dinner
- Restrictions
- Water intake target
- Approx calories: ${answers.calories} kcal
Portions must be realistic. Avoid repetition.
`;

  try {
    const resp = await fetch(API_URL, {
      method: "POST",
      headers: {
        Authorization: `Bearer ${OPENAI_API_KEY}`,
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        model: "llama-3.1-8b-instant",
        messages: [{ role: "user", content: prompt }],
        temperature: 0.7,
      }),
    });

    const data = await resp.json();

    if (data.error) return append("bot", "‚ö†Ô∏è " + data.error.message);

    const text = data?.choices?.[0]?.message?.content || "No diet generated.";
    append("bot", text);
    createPDFButton(text);
  } catch (err) {
    append("bot", "‚ö† Network/API issue.");
  }
}

// === PDF Export ===
function createPDFButton(text) {
  const btn = document.createElement("button");
  btn.textContent = "Export Diet (PDF)";
  btn.onclick = () => exportPDF(text);
  promptArea.appendChild(btn);
}

function exportPDF(txt) {
  const win = window.open("", "_blank");
  win.document.write(`<pre>${txt}</pre>`);
  win.print();
}

// Start
append("bot", "Welcome to NutriMate your personal diet planner ü§ñüçè");
renderQuestion(index);
</script>
</body>
</html>
